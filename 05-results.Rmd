# Results

```{r, include=FALSE}
source("srcs/helpers.R")
load(file = "data/processing/imdb(cleaned).RData")
imdb_pure -> imdb
load(file="data/processing/imdb_people.RData")
load(file = "data/processing/movie_genre_map.RData" )
load(file = "data/processing/genres_mappers.RData")
```

At this part, we want you to imagine you are a producer of a film company or an investor that are evaluating on a movie construction project.

Then this page will serve as a cookbook for you to make such decision!

## Get Ready to Fail

From a historical standpoint, we look a strong long tail effect on film industry, that is, minority make up to be majority.

```{r fig.width=9, fig.height=7.2}
imdb %>%
  #sample_frac(0.1) %>%
  left_join(geners_type_map) %>%

ggplot() +
  aes(x = factor(startYear),
      y = numVotes,
      fill = Genres_type) +
  geom_point(aes(color = Genres_type),
             size = .9,
             alpha = 0.25,
             stroke = 0.7) +
  scale_y_continuous(labels = axis_unit_scaler_1, 
                     breaks = pretty_breaks(10)) +
  scale_x_discrete(breaks = pretty_breaks(10)) +
  scale_fill_manual(values = JACE_COLOR, guide = "none") +
  scale_color_manual(values = JACE_COLOR, guide = "none") +
  labs(x = "Start Year",
       y = 'Number of Votes') +
  theme_jace +
  get_lightxy(0.6) -> p_scatter

imdb %>%
  #sample_frac(0.1) %>%
  left_join(geners_type_map) %>%
 
ggplot() +
  aes(x = factor(startYear)) + #
  geom_histogram(stat="count",
                 aes(color = Genres_type, fill = Genres_type)) +
  labs(x = "", 
       y = "# of Movies",
       fill = "Type of Genres",
       color = "Type of Genres",) +
  scale_fill_manual(values = JACE_COLOR) +
  scale_color_manual(values = JACE_COLOR) +
  scale_y_continuous(labels = axis_unit_scaler_1, breaks = pretty_breaks(3)) +
  scale_x_discrete(breaks = pretty_breaks(10)) +
  theme_jace +
  get_lightxy(0.6)   -> p_startYear

imdb %>%
  #sample_frac(0.1) %>%
  left_join(geners_type_map) %>%
  
ggplot() +
  aes(y = numVotes, 
      x = "",
      fill = Genres_type) + #
  geom_flat_violin(position = position_nudge(x = .15), 
                   alpha = .8) +
  geom_point(aes(color = Genres_type), 
             position = position_jitter(width = .10),
             size = .3, 
             alpha = .5,
             show.legend = F) +
  labs(x = "", 
       y = "") +
  scale_fill_manual(values = JACE_COLOR, guide = "none") +
  scale_color_manual(values = JACE_COLOR, guide = "none") +
  scale_y_continuous(labels = axis_unit_scaler_1, breaks = pretty_breaks(10)) +
  scale_x_discrete(expand = c(0, 0)) +
  theme_jace -> p_numVotes



layout = "11333333333
          11333333333
          11333333333
          11333333333
          11333333333
          11333333333
          11333333333
          ##222222222
          ##222222222"
      
p_numVotes + p_startYear + p_scatter + 
  plot_layout(design = layout, guide = "collect") + 
  labs(title = "Number of IMDb Votes of each movie over the year",
       subtitle = "Left subgraph: density of votes # | Bottom subgraph: histogram of start year")
```

- From the main graph, we see the peaks of the popularity (# of votes people give in IMDB) goes higher along with more and more movies are released seen in the bottom subgraph.

- However, the left graph shows a severe concentrating on movies with very low votes. Let dive in to see this "80-20 rule".

    ```{r}
    tibble(`%` = c(0, 0.25, 0.50, 0.75, 0.8, 0.85, 0.9, 0.95, 0.97, 0.99, 0.995, 0.999),
           `Quantiles of # of Votes` = quantile(imdb$numVotes, probs = `%`, type=3)) %>%
      rowwise() %>%
      mutate(`%` = percent_format(0.1)(`%`),
             `% of votes for movies <= Quantiles` = sum(imdb %>% filter(numVotes <= `Quantiles of # of Votes`) %>% pull(numVotes), na.rm=T) / sum(imdb$numVotes, na.rm=T),
             `Examples` = imdb %>% filter(numVotes >= `Quantiles of # of Votes`) %>% arrange(numVotes) %>% slice(1:2) %>% summarise(title = paste0(primaryTitle, collapse = "<br/>")) %>% pull(title)) %>%
      ungroup %>%
      mutate(`% of votes for movies <= Quantiles` = percent_format()(`% of votes for movies <= Quantiles`),
             `Examples` = gsub("Vice Squad", 
                               '<span style="background-color: #277cee44">Vice Squad</span>', Examples)) %>%
      get_DT(button = F, default_show = 20)
    ```

  - Surprisingly, "80-20 rule" is now: 80% movies receives 1.864% of votes given to them, and this number is more low for commericial statistics like box office.
  
  - Why? Because most of the movies are rarely known to genreal public. For example, I asked several friends and none of them ever heard of [Vice Squad](https://www.imdb.com/title/tt0084861/), which receives 666	votes and this number is higher than 85% of the movies in the entire IMDb database.
  
  
## Follow the Best Practices

Despite this long tail effect, there are still movies that achieved both commercial success (high profit and high box offices), and high rating:

```{r}
imdb %>%
  arrange(-WorldwideGross) %>%
  slice(1:30) -> temp

temp %>%
ggplot() +
  aes(x = ROI,
      y = averageRating,
      size = WorldwideGross) +
  geom_point(aes(color = mainGenres),
             position = position_jitter(w = .15),
             #size = 4,
             alpha = 0.5) +
  geom_vline(xintercept = median(temp$ROI),
           color = "black",
           linetype = "dashed") +
  geom_hline(yintercept = median(temp$averageRating),
           color = "black",
           linetype = "dashed") +

  geom_text_repel(aes(label = originalTitle),
                  color = "gray25",
                  family = "Times New Roman",
                  show.legend=F) +
  theme_classic() +
  scale_size_continuous(range = c(1.8, 5.2),   
                        breaks = pretty_breaks(5), 
                        labels = axis_unit_scaler_1) +
  scale_color_manual(values = brewer.pal(9, "Spectral")) +
  theme(axis.line = element_blank()) +
  get_lightxy(0.75) +
  labs(x = "ROI (box office / production budget)",
       y = "IMDb Rating (0-10)",
       color = "Genres",
       size = "Total Box office ($)",
       title = "Scatter plot matrix of Rating vs ROI",
       subtitle = "1900-2021 Top 30 movies with highest box office") +
  center_title +
  text_theme
```

- These plots show the all time top 30 movies that generates highest box office.

- In the top right area (ROI >= the median 6.74, Rating >= the median 7.25), we can see 

  - *The Lord of the Rings* achieves 12 times return on investment while maintains a high rating close to 9. 
  
  - *Avatar* gets highest box office (2,845,899,541 dollars) in film history. 
  
## C