---
output: html_document
editor_options: 
  chunk_output_type: console
---
# Results

```{r, include=FALSE}
source("srcs/helpers.R")
load(file = "data/processing/imdb.RData")

imdb %<>%
  filter(startYear < 2022)
```


In this project, we want to discover the contributing factors that make a movie more successful than others. So we have raised the following questions.

- What specific features do movies with higher profitability have?

- What contributes to higher-rating films?

- Is commercial success (high profit and high box offices) positively correlated with high rating or a trade-off?

## Long tail effect: minority make up majority

```{r}
COLOR_TEMP = c("#d5896f","#dab785","#70a288")

imdb %>%
  group_by(mainGenres) %>%
  summarise(n = n()) %>%
  arrange(-n) %>%
  mutate(Genres_type = ifelse(min_rank(-n) <=10, mainGenres, "Others") %>%
           factor %>% fct_relevel("Others", after=Inf)) -> df_geners

imdb %>%
  sample_frac(0.1) %>%
  left_join(df_geners) %>%

ggplot() +
  aes(x = factor(startYear),
      y = numVotes,
      fill = Genres_type) +
  geom_point(aes(color = Genres_type),
             size = .9,
             alpha = 0.25,
             stroke = 0.7) +
  scale_y_continuous(labels = axis_unit_scaler_1, 
                     breaks = pretty_breaks(10)) +
  scale_x_discrete(breaks = pretty_breaks(10)) +
  scale_fill_manual(values = JACE_COLOR, guide = "none") +
  scale_color_manual(values = JACE_COLOR, guide = "none") +
  labs(x = "Start Year",
       y = 'Number of Votes') +
  theme_jace +
  get_lightxy(0.6) -> p_scatter

imdb %>%
  sample_frac(0.1) %>%
  left_join(df_geners) %>%
 
ggplot() +
  aes(x = factor(startYear)) + #
  geom_histogram(stat="count",
                 aes(color = Genres_type, fill = Genres_type)) +
  labs(x = "", 
       y = "# of Movies",
       fill = "Type of Genres",
       color = "Type of Genres",) +
  scale_fill_manual(values = JACE_COLOR) +
  scale_color_manual(values = JACE_COLOR) +
  scale_y_continuous(labels = axis_unit_scaler_1, breaks = pretty_breaks(3)) +
  scale_x_discrete(breaks = pretty_breaks(10)) +
  theme_jace +
  get_lightxy(0.6)   -> p_startYear

imdb %>%
  sample_frac(0.1) %>%
  left_join(df_geners) %>%
  
ggplot() +
  aes(y = numVotes, 
      x = "",
      fill = Genres_type) + #
  geom_flat_violin(position = position_nudge(x = .15), 
                   alpha = .8) +
  geom_point(aes(color = Genres_type), 
             position = position_jitter(width = .10),
             size = .3, 
             alpha = .5,
             show.legend = F) +
  labs(x = "", 
       y = "") +
  scale_fill_manual(values = JACE_COLOR, guide = "none") +
  scale_color_manual(values = JACE_COLOR, guide = "none") +
  scale_y_continuous(labels = axis_unit_scaler_1, breaks = pretty_breaks(10)) +
  scale_x_discrete(expand = c(0, 0)) +
  theme_jace -> p_numVotes



layout = "11333333333
          11333333333
          11333333333
          11333333333
          11333333333
          11333333333
          11333333333
          ##222222222
          ##222222222"
      
p_numVotes + p_startYear + p_scatter + 
  plot_layout(design = layout, guide = "collect") + 
  labs(title = " Main graph: Number of Votes of each movie over the year",
       subtitle = "Left subgraph: density of votes # | Bottom subgraph: histogram of start year")
```


```{r out.width=100}
tibble(`%` = c(0, 0.25, 0.50, 0.75, 0.8, 0.85, 0.9, 0.95, 0.97, 0.99, 0.995, 0.999, 0.9999),
       `Quantiles of # of Votes` = quantile(imdb$numVotes, probs = `%`, type=3)) %>%
  rowwise() %>%
  mutate(`%` = percent_format(0.01)(`%`),
         `Number of rows >= Quantiles` = imdb %>% filter(numVotes >= `Quantiles of # of Votes`) %>% nrow(),
         `Examples` = imdb %>% filter(numVotes >= `Quantiles of # of Votes`) %>% arrange(numVotes) %>% slice(1:3) %>% summarise(title = paste0(primaryTitle, collapse = "<br/>")) %>% pull(title)) %>%
  ungroup %>%
  mutate(`Examples` = gsub("The Golden Chance", '<span style="background-color: #277cee44">The Golden Chance</span>', Examples)) %>%
  get_DT(button = F, default_show = 20)
```

- It's not surprising to find out that over 90% of the movies do not have votes over 500. We consider 1000 as a threshold to determine the movie is at least not unknown to the general public.

  - For example, I asked several friends and none of them ever heard of [The Golden Chance](https://www.imdb.com/title/tt0005402/), which receives 227 votes and this number is higher than 85% of the movies in the entire imdb database.

## What specific features do movies with higher profitability have?

- First, we can use the budget data provided by the-numbers to estimate the cost, and then combine it with box offices to calculate the revenue of each movie.

- Through IMDB's main data, we can analyze the genres of movies, popularity of the star/director/screenwriter, or the runtime of  movies that can bring high profits.

## What contributes to higher-rating films?



- In addition to using the same data as the first question, we can also use review data provided by Stanford to discover how people think when lots of people give high scores to a movie.




```{r}
imdb %>%
  arrange(-numVotes)
```


- Also, there might be some relationship between the rating volume and rating in IMDBâ€™s scoring system.

## Is commercial success (high profit and high box offices) positively correlated with high rating or a trade-off?

- A scatter plot with lm lines of box office versus ratings, for example, can reveal their relationship.

- A matrix can also be drawn to filter those outliers in the first and fourth quadrant (high box office but low score, or high score but low box office). We can extract keywords from their review, generate word cloud plots to analyze their characteristics.
